<div class="client-block">
  <strong>Livraisons et retours par surface</strong>
</div>

<table class="article">
  <col width="200">
  <col width="75">
  <col width="75">
  <col width="75">
  <col width="75">
  <col width="75">

  <tr>
    <strong>
      <th>Caisses</th>
      <th class="text-center">Envoyées</th>
      <th class="text-center">Retours Propres</th>
      <th class="text-center">Retours Sales</th>
      <th class="text-center">Retours Scellées Sales</th>
      <th class="text-center">Total Retour</th>
    </strong>
  </tr>

<% Offer.where(:event_id => Event.where(:is_lln => true).last.id).where(created_at: @invoice.week_begin..@invoice.week_finish).each do |offer| %>

  <% if offer.organizer.lln_id >= 1%>

  <tr>
    <td><strong><%= offer.created_at.strftime("%d/%m/%Y") %> - <%= offer.organizer.name %></strong></td>
    <td></td>
    <td class="text-center"></td>
    <td class="text-center"></td>
    <td class="text-center"></td>
    <td class="text-center"></td>
  </tr>

    <% Box.all.each do |box| %>

      <% if offer.sent_boxes(box) >=1 or offer.returned_boxes(box) >= 1 %>

        <tr>

          <td><%= box.box_name %></td>
          <td class="text-center"><%= offer.sent_boxes(box) %></td>
          <td class="text-center"><%= offer.clean_boxes(box) %></td>
          <td class="text-center"><%= offer.dirty_boxes(box) %></td>
          <td class="text-center"><%= offer.sealed_boxes(box) %></td>
          <td class="text-center"><%= offer.returned_boxes(box) %></td>
        </tr>



<% end %>
<% end %>
<% end %>
<% end %>

</table>

<hr>

<table class="article">

  <tr>
    <strong>
    <th>Articles</th>
    <th class="text-center">Lavés</th>
    <th class="text-center">Lavage Manuel</th>
    <th class="text-center">Manutention</th>
    <th class="text-center">Cassés</th>
    </strong>
  </tr>

<% Offer.where(:event_id => Event.where(:is_lln => true).last.id).where(created_at: @invoice.week_begin..@invoice.week_finish).each do |offer| %>

  <% if offer.organizer.lln_id >= 1%>

    
    <tr>
      <td><strong><%= offer.created_at.strftime("%d/%m/%Y") %> - <%= offer.organizer.name %></strong></td>
      <td></td>
      <td class="text-center"></td>
      <td class="text-center"></td>
      <td class="text-center"></td>
      <td class="text-center"></td>
    </tr>

    <% Article.all.each do |article| %>

      <% if offer.total_articles(article) >= 1 %>

        <tr>

          <td><%= article.article_name %></td>
          <td class="text-center"><%= offer.washed_articles(article) %></td>
          <td class="text-center"><%= offer.very_dirty_articles(article) %></td>
          <td class="text-center"><%= offer.handling_articles(article) %></td>
          <td class="text-center"><%= offer.broken_articles(article) %></td>
        </tr>

      <% end %>

    <% end %>
  <% end %>

<% end %>

</table>
