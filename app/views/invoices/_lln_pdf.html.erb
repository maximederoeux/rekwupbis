Début et fin de semaine passée<br>

<%= @invoice.week_begin.strftime("%d/%m/%Y") %><br>
<%= @invoice.week_finish.strftime("%d/%m/%Y") %><br>

<hr>

Dates début et fin de semaine passée<br>
<%= (@invoice.created_at.beginning_of_week - 7.days).strftime("%d/%m/%Y") %><br>
<%= (@invoice.created_at.end_of_week - 7.days).strftime("%d/%m/%Y") %><br>

<hr>

Offres LLN entre début et fin de semaine passée
<% Offer.where(:event_id => Event.where(:is_lln => true).last.id).where(created_at: @invoice.week_begin..@invoice.week_finish).each do |offer| %>

<%= offer.organizer.full_name %>
<%= offer.created_at.strftime("%d/%m/%Y") %><br>

<% end %>


<hr>

Caisses envoyées et reçues<br>

<% Box.all.each do |box| %>

<% if @invoice.sent_boxes_week(box) >=1 or @invoice.returned_boxes_week(box) >= 1 %>

<%= box.box_name %>
<%= @invoice.sent_boxes_week(box) %>
<%= @invoice.clean_boxes_week(box) %>
<%= @invoice.dirty_boxes_week(box) %>
<%= @invoice.sealed_boxes_week(box) %>
<%= @invoice.returned_boxes_week(box) %><br>


<% end %>
<% end %>

<hr>

Articles lavés etc<br>

<% Article.all.each do |article| %>

<% if @invoice.total_articles_week(article) >= 1 %>

<%= article.article_name %>
<%= @invoice.sent_articles_week(article) %>
<%= @invoice.washed_articles_week(article) %>
<%= @invoice.very_dirty_articles_week(article) %>
<%= @invoice.handling_articles_week(article) %>
<%= @invoice.broken_articles_week(article) %>
<%= @invoice.total_articles_week(article) %>
<%= @invoice.right_wash_price(article) %>
<%= @invoice.right_handwash_price(article) %>
<%= @invoice.right_handling_price(article) %>
<%= @invoice.washed_htva_week(article) %>
<%= @invoice.handwash_htva_week(article) %>
<%= @invoice.handling_htva_week(article) %>
<%= @invoice.deposit_htva_week(article) %>
<%= @invoice.total_per_article_htva_week(article) %><br>

<% end %>
<% end %>

<hr>

Total HTVA <%= @invoice.total_all_articles_htva_week %><br>
Total TVA <%= @invoice.total_all_articles_tva_week %><br>
Total TVAC <%= @invoice.total_all_articles_tvac_week %><br>

<hr>

<% Offer.where(:event_id => Event.where(:is_lln => true).last.id).where(created_at: @invoice.week_begin..@invoice.week_finish).each do |offer| %>


  <%= offer.created_at.strftime("%d/%m/%Y") %>
  <%= offer.organizer.name %><br>


  <% Article.all.each do |article| %>

    <% if offer.total_articles(article) >= 1 %>

      <%= article.article_name %>

      <%= offer.washed_articles(article) %>
      <%= offer.very_dirty_articles(article) %>
      <%= offer.handling_articles(article) %>
      <%= offer.broken_articles(article) %><br>

    <% end %>

  <% end %>

<% end %>

